# Hamigaki Bjam Library Jamfile

# Copyright Takeshi Mouri 2007.
# Distributed under the Boost Software License, Version 1.0.
# (See accompanying file LICENSE_1_0.txt or copy at
# http://www.boost.org/LICENSE_1_0.txt)

# See http://hamigaki.sourceforge.jp/libs/bjam for library home page.

subproject libs/bjam/build ;

SOURCES =
    builtin_rules
    class
    instantiate_bjam_exprgr
    instantiate_bjam_grammar
    path
    pattern
    variable_expansion
    ;

lib hamigaki_bjam
    :
        ../src/$(SOURCES).cpp
    :
        [ common-names ]
        <include>$(HAMIGAKI_ROOT)  <sysinclude>$(HAMIGAKI_ROOT)
        <include>$(BOOST_INCLUDE)  <sysinclude>$(BOOST_INCLUDE)
        <vc-8_0><*><cflags>-wd4996
        <vc-8_0><*><cflags>-wd4819
    :
        debug release
    ;

dll hamigaki_bjam
    :
        ../src/$(SOURCES).cpp
    :
        <library-path>$(BOOST_LIBPATH)
        [ common-names ]
        <define>HAMIGAKI_BJAM_DYN_LINK=1
        <runtime-link>dynamic
        <include>$(HAMIGAKI_ROOT)  <sysinclude>$(HAMIGAKI_ROOT)
        <include>$(BOOST_INCLUDE)  <sysinclude>$(BOOST_INCLUDE)
        <vc-8_0><*><cflags>-wd4996
        <vc-8_0><*><cflags>-wd4819
    :
        debug release
    ;

install bjam lib
     : <lib>hamigaki_bjam <dll>hamigaki_bjam
     ;

stage stage/lib
    : <lib>hamigaki_bjam <dll>hamigaki_bjam
    : # copy to a path rooted at HAMIGAKI_ROOT:
      <locate>$(HAMIGAKI_ROOT)
      [ common-names ]
      <target>stage
      <target>all
    : # build variants
      debug release
    ;
